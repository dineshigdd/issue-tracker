<!doctype html>
<html>
<head>
    <title>Issue tracker login</title>

    <meta charset="utf-8" />
    <meta http-equiv="Content-type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" href="/styles/styles.css">
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
</head>

<body>
<div>
        <form>   
            
            <label>First name</label><input id="firstName" type="text" name="firstName"/>
            <label>Last name</label><input id="lastName" type="text" name="lastName"/>        
            <label>username</label><input id="email" type="email" name="username"/>
            <label>password</label><input id="password" type="password" name="password"/>
            <button type="submit" id="submit">Register</button>
            <a href="/">Log in</a>

        </form>

        <script>
                const submitUser = (userData) =>{           
                    // console.log( "sign up")
                        return axios.post('/api/users/signup', userData)
                        .then( response => {
                            // const addedUser = response.data;
                            const{ token, project } = response.data;
                            localStorage.setItem('jwtToken', token);
                            setAuthToken(token);
                            // const decoded = parseJwt(token);
                            console.log(`POST: user is added`, addedUser);  
                            // document.location = addedUser.project;
                            
                            
                        }).catch(error => console.error(error))
                
                }


                const form = document.querySelector('form');
       
                form.addEventListener('submit',event => {
                event.preventDefault();
            
                const first_name = document.querySelector('#firstName').value;
                const last_name = document.querySelector('#lastName').value;
                const email = document.querySelector('#email').value;
                const password = document.querySelector('#password').value;
                    
                const user = { first_name, last_name , email, password };

                submitUser(user);
                })

        </script>